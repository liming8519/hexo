---
tags: [linux]
title: 反向映射
created: '2020-03-10T08:00:47.228Z'
modified: '2020-03-10T08:04:11.622Z'
---

> 反向映射

<!-- more -->
```c++
struct page{
      　　struct address_space *mapping;  /* address_space类型，为对齐需要，其值为4的位数，所以最低两位无用，为充分利用资源，所以此处利用此最低位。
                                           * 最低位为1表示该页为匿名页，并且它指向anon_vma对象。                                         
                                           * 最低为0表映射页，此时mapping指向文件节点地址空间。*/
          atomic_t _mapcount;             /* 取值-1时表示没有指向该页框的引用，                             
                                           *取值0时表示该页框不可共享  
                                           *取值大于0时表示该页框可共享表示有几个PTE引用 */
          pgoff_t index;
};

struct mm_struct {
    pgd_t * pgd;
}

struct vm_area_struct {
    struct list_head anon_vma_node;    /* Serialized by anon_vma->lock */
    struct anon_vma *anon_vma;    /* Serialized by page_table_lock */
}   


struct anon_vma {
    spinlock_t lock;    /* Serialize access to vma list */
    struct list_head head;    /* List of private "related" vmas */
};
```

